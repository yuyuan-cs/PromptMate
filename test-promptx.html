<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PromptX åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-section {
            background: white;
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 12px;
        }
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-right: 8px;
            margin-bottom: 8px;
        }
        .test-button:hover {
            background: #2563eb;
        }
        .result-box {
            background: #f1f5f9;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
            font-family: monospace;
            font-size: 13px;
        }
        .success {
            color: #059669;
            font-weight: bold;
        }
        .error {
            color: #dc2626;
            font-weight: bold;
        }
        .role-card {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 12px;
            background: #fafafa;
        }
        .badge {
            display: inline-block;
            background: #e2e8f0;
            color: #475569;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-right: 4px;
            margin-bottom: 4px;
        }
        .examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }
        .example-btn {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            text-align: left;
            font-size: 13px;
        }
        .example-btn:hover {
            background: #f1f5f9;
            border-color: #3b82f6;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ PromptX åŠŸèƒ½æµ‹è¯•é¡µé¢</h1>
        <p>æµ‹è¯• PromptMate çš„ PromptX æ ¸å¿ƒåŠŸèƒ½ï¼šè‡ªç„¶å¯¹è¯æ¿€æ´»è§’è‰²ç³»ç»Ÿ</p>
    </div>

    <div class="test-section">
        <h2>ğŸ­ æ™ºèƒ½è§’è‰²æ¿€æ´»æµ‹è¯•</h2>
        <p>è¾“å…¥è‡ªç„¶è¯­è¨€æè¿°ï¼Œæµ‹è¯•è§’è‰²è¯†åˆ«å’Œæ¿€æ´»åŠŸèƒ½ï¼š</p>
        
        <textarea id="userInput" class="test-input" rows="3" 
                  placeholder="å‘Šè¯‰æˆ‘æ‚¨éœ€è¦ä»€ä¹ˆå¸®åŠ©ï¼Œæ¯”å¦‚ï¼šæˆ‘éœ€è¦äº§å“ç»ç†ä¸“å®¶å¸®æˆ‘åˆ†æç”¨æˆ·éœ€æ±‚..."></textarea>
        
        <div>
            <button class="test-button" onclick="testRoleActivation()">ğŸ” åˆ†æè§’è‰²æ„å›¾</button>
            <button class="test-button" onclick="getSuggestions()">ğŸ’¡ è·å–è§’è‰²å»ºè®®</button>
            <button class="test-button" onclick="clearResults()">ğŸ—‘ï¸ æ¸…ç©ºç»“æœ</button>
        </div>

        <div class="examples">
            <button class="example-btn" onclick="useExample('æˆ‘éœ€è¦äº§å“ç»ç†ä¸“å®¶å¸®æˆ‘åˆ†æç”¨æˆ·éœ€æ±‚')">
                æˆ‘éœ€è¦äº§å“ç»ç†ä¸“å®¶å¸®æˆ‘åˆ†æç”¨æˆ·éœ€æ±‚
            </button>
            <button class="example-btn" onclick="useExample('éœ€è¦ç³»ç»Ÿæ¶æ„å¸ˆæŒ‡å¯¼æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡')">
                éœ€è¦ç³»ç»Ÿæ¶æ„å¸ˆæŒ‡å¯¼æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡
            </button>
            <button class="example-btn" onclick="useExample('è¯·æ–‡æ¡ˆç­–åˆ’å¸®æˆ‘å†™ä¸ªè¥é”€æ–‡æ¡ˆ')">
                è¯·æ–‡æ¡ˆç­–åˆ’å¸®æˆ‘å†™ä¸ªè¥é”€æ–‡æ¡ˆ
            </button>
            <button class="example-btn" onclick="useExample('éœ€è¦UIè®¾è®¡å¸ˆä¼˜åŒ–ç•Œé¢ä½“éªŒ')">
                éœ€è¦UIè®¾è®¡å¸ˆä¼˜åŒ–ç•Œé¢ä½“éªŒ
            </button>
            <button class="example-btn" onclick="useExample('è¯·æ•°æ®åˆ†æå¸ˆå¸®æˆ‘åˆ†æç”¨æˆ·è¡Œä¸º')">
                è¯·æ•°æ®åˆ†æå¸ˆå¸®æˆ‘åˆ†æç”¨æˆ·è¡Œä¸º
            </button>
            <button class="example-btn" onclick="useExample('æˆ‘æƒ³è¦ä¸€ä¸ªä¸“ä¸šçš„å¸®åŠ©')">
                æˆ‘æƒ³è¦ä¸€ä¸ªä¸“ä¸šçš„å¸®åŠ© (æ¨¡ç³Šè¯·æ±‚)
            </button>
        </div>

        <div id="results" class="result-box" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ“š ä¸“ä¸šè§’è‰²åº“</h2>
        <p>å½“å‰ç³»ç»Ÿä¸­çš„ä¸“ä¸šè§’è‰²ï¼š</p>
        <div id="roleLibrary"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ§  å¯¹è¯ç†è§£å¼•æ“çŠ¶æ€</h2>
        <div>
            <button class="test-button" onclick="testDialogueEngine()">ğŸ”¬ è¿è¡Œå¼•æ“æµ‹è¯•</button>
            <button class="test-button" onclick="showEngineStats()">ğŸ“Š æ˜¾ç¤ºå¼•æ“ç»Ÿè®¡</button>
        </div>
        <div id="engineStatus" class="result-box" style="display: none;"></div>
    </div>

    <script>
        // æ¨¡æ‹Ÿ PromptX æ ¸å¿ƒåŠŸèƒ½
        class MockDialogueEngine {
            constructor() {
                this.rolePatterns = [
                    { pattern: /éœ€è¦.*äº§å“ç»ç†|äº§å“.*ä¸“å®¶|PM.*å¸®åŠ©/i, roleId: 'product-manager', name: 'äº§å“ç»ç†' },
                    { pattern: /éœ€è¦.*æ¶æ„å¸ˆ|ç³»ç»Ÿ.*è®¾è®¡|æ¶æ„.*å»ºè®®/i, roleId: 'architect', name: 'ç³»ç»Ÿæ¶æ„å¸ˆ' },
                    { pattern: /éœ€è¦.*æ–‡æ¡ˆ|å†™.*æ–‡æ¡ˆ|è¥é”€.*æ–‡æœ¬/i, roleId: 'copywriter', name: 'æ–‡æ¡ˆç­–åˆ’' },
                    { pattern: /éœ€è¦.*è®¾è®¡å¸ˆ|UI.*è®¾è®¡|ç•Œé¢.*è®¾è®¡/i, roleId: 'ui-designer', name: 'UIè®¾è®¡å¸ˆ' },
                    { pattern: /éœ€è¦.*æ•°æ®.*åˆ†æ|æ•°æ®.*ä¸“å®¶/i, roleId: 'data-analyst', name: 'æ•°æ®åˆ†æå¸ˆ' }
                ];
                this.activationKeywords = ['éœ€è¦', 'å¸®åŠ©', 'ä¸“å®¶', 'ååŠ©', 'æŒ‡å¯¼'];
            }

            async parseUserIntent(message) {
                const hasActivationIntent = this.activationKeywords.some(keyword => 
                    message.toLowerCase().includes(keyword)
                );
                
                if (!hasActivationIntent) return null;

                for (const pattern of this.rolePatterns) {
                    if (pattern.pattern.test(message)) {
                        return {
                            roleId: pattern.roleId,
                            roleName: pattern.name,
                            confidence: 0.85 + Math.random() * 0.1,
                            originalMessage: message,
                            extractedKeywords: this.extractKeywords(message)
                        };
                    }
                }
                return null;
            }

            async suggestRoles(message) {
                const suggestions = [];
                for (const pattern of this.rolePatterns) {
                    const keywords = pattern.name.split('');
                    if (keywords.some(k => message.includes(k))) {
                        suggestions.push({
                            roleId: pattern.roleId,
                            name: pattern.name,
                            confidence: 0.3 + Math.random() * 0.4,
                            reason: `æ£€æµ‹åˆ°ç›¸å…³å…³é”®è¯`
                        });
                    }
                }
                return suggestions.sort((a, b) => b.confidence - a.confidence).slice(0, 3);
            }

            extractKeywords(message) {
                const keywords = [];
                this.rolePatterns.forEach(pattern => {
                    if (pattern.pattern.test(message)) {
                        keywords.push(pattern.name);
                    }
                });
                this.activationKeywords.forEach(keyword => {
                    if (message.includes(keyword)) {
                        keywords.push(keyword);
                    }
                });
                return [...new Set(keywords)];
            }
        }

        class MockProfessionalRoles {
            constructor() {
                this.roles = [
                    {
                        id: 'product-manager',
                        name: 'äº§å“ç»ç†',
                        description: 'å…·å¤‡å®Œæ•´äº§å“ç®¡ç†ç»éªŒçš„ä¸“ä¸šäº§å“ç»ç†',
                        capabilities: ['éœ€æ±‚åˆ†æ', 'ç”¨æˆ·ç ”ç©¶', 'äº§å“è§„åˆ’', 'ç«å“åˆ†æ'],
                        category: 'äº§å“ä¸è®¾è®¡'
                    },
                    {
                        id: 'architect',
                        name: 'ç³»ç»Ÿæ¶æ„å¸ˆ',
                        description: 'å…·å¤‡ä¸°å¯Œç³»ç»Ÿè®¾è®¡ç»éªŒçš„æŠ€æœ¯æ¶æ„ä¸“å®¶',
                        capabilities: ['ç³»ç»Ÿè®¾è®¡', 'æŠ€æœ¯é€‰å‹', 'æ€§èƒ½ä¼˜åŒ–', 'æ¶æ„è¯„å®¡'],
                        category: 'æŠ€æœ¯å¼€å‘'
                    },
                    {
                        id: 'copywriter',
                        name: 'æ–‡æ¡ˆç­–åˆ’',
                        description: 'å…·å¤‡ä¸°å¯Œè¥é”€æ–‡æ¡ˆç»éªŒçš„ä¸“ä¸šç­–åˆ’å¸ˆ',
                        capabilities: ['å“ç‰Œæ–‡æ¡ˆ', 'è¥é”€å†…å®¹', 'å¹¿å‘Šæ–‡æ¡ˆ', 'ç¤¾äº¤åª’ä½“'],
                        category: 'è¥é”€ä¼ æ’­'
                    },
                    {
                        id: 'ui-designer',
                        name: 'UI/UXè®¾è®¡å¸ˆ',
                        description: 'å…·å¤‡ä¸°å¯Œç”¨æˆ·ä½“éªŒè®¾è®¡ç»éªŒçš„ä¸“ä¸šè®¾è®¡å¸ˆ',
                        capabilities: ['ç”¨æˆ·ä½“éªŒè®¾è®¡', 'ç•Œé¢è®¾è®¡', 'äº¤äº’åŸå‹', 'å¯ç”¨æ€§æµ‹è¯•'],
                        category: 'äº§å“ä¸è®¾è®¡'
                    },
                    {
                        id: 'data-analyst',
                        name: 'æ•°æ®åˆ†æå¸ˆ',
                        description: 'å…·å¤‡ä¸°å¯Œæ•°æ®åˆ†æç»éªŒçš„ä¸“ä¸šåˆ†æå¸ˆ',
                        capabilities: ['æ•°æ®æ”¶é›†', 'ç»Ÿè®¡åˆ†æ', 'æ•°æ®å¯è§†åŒ–', 'å•†ä¸šæ™ºèƒ½'],
                        category: 'æ•°æ®ç§‘å­¦'
                    }
                ];
            }

            getAllRoles() {
                return this.roles;
            }

            getRoleById(roleId) {
                return this.roles.find(role => role.id === roleId);
            }
        }

        // åˆå§‹åŒ–æ¨¡æ‹Ÿå¯¹è±¡
        const dialogueEngine = new MockDialogueEngine();
        const professionalRoles = new MockProfessionalRoles();

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºè§’è‰²åº“
        window.onload = function() {
            displayRoleLibrary();
        };

        function useExample(text) {
            document.getElementById('userInput').value = text;
        }

        async function testRoleActivation() {
            const input = document.getElementById('userInput').value.trim();
            if (!input) {
                showResults('è¯·è¾“å…¥æµ‹è¯•æ¶ˆæ¯', 'error');
                return;
            }

            try {
                const intent = await dialogueEngine.parseUserIntent(input);
                const suggestions = await dialogueEngine.suggestRoles(input);

                let result = `ğŸ“ æµ‹è¯•æ¶ˆæ¯: "${input}"\n\n`;
                
                if (intent) {
                    result += `âœ… è§’è‰²è¯†åˆ«æˆåŠŸ!\n`;
                    result += `ğŸ­ è¯†åˆ«è§’è‰²: ${intent.roleName}\n`;
                    result += `ğŸ¯ ç½®ä¿¡åº¦: ${Math.round(intent.confidence * 100)}%\n`;
                    result += `ğŸ·ï¸ å…³é”®è¯: ${intent.extractedKeywords.join(', ')}\n\n`;
                    
                    const role = professionalRoles.getRoleById(intent.roleId);
                    if (role) {
                        result += `ğŸ“‹ è§’è‰²è¯¦æƒ…:\n`;
                        result += `- æè¿°: ${role.description}\n`;
                        result += `- åˆ†ç±»: ${role.category}\n`;
                        result += `- èƒ½åŠ›: ${role.capabilities.join(', ')}\n`;
                    }
                } else {
                    result += `âŒ æœªè¯†åˆ«åˆ°æ˜ç¡®çš„è§’è‰²æ„å›¾\n\n`;
                }

                if (suggestions.length > 0) {
                    result += `ğŸ’¡ æ¨èè§’è‰²:\n`;
                    suggestions.forEach((suggestion, index) => {
                        result += `${index + 1}. ${suggestion.name} (${Math.round(suggestion.confidence * 100)}%) - ${suggestion.reason}\n`;
                    });
                } else {
                    result += `ğŸ’¡ æš‚æ— è§’è‰²æ¨è\n`;
                }

                showResults(result, 'success');
            } catch (error) {
                showResults(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function getSuggestions() {
            const input = document.getElementById('userInput').value.trim();
            if (!input) {
                showResults('è¯·è¾“å…¥æµ‹è¯•æ¶ˆæ¯', 'error');
                return;
            }

            try {
                const suggestions = await dialogueEngine.suggestRoles(input);
                let result = `ğŸ’¡ è§’è‰²å»ºè®® (åŸºäº: "${input}"):\n\n`;
                
                if (suggestions.length > 0) {
                    suggestions.forEach((suggestion, index) => {
                        result += `${index + 1}. ${suggestion.name}\n`;
                        result += `   ç½®ä¿¡åº¦: ${Math.round(suggestion.confidence * 100)}%\n`;
                        result += `   åŸå› : ${suggestion.reason}\n\n`;
                    });
                } else {
                    result += 'æš‚æ— ç›¸å…³è§’è‰²å»ºè®®';
                }

                showResults(result, 'success');
            } catch (error) {
                showResults(`âŒ è·å–å»ºè®®å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testDialogueEngine() {
            const testMessages = [
                'æˆ‘éœ€è¦äº§å“ç»ç†ä¸“å®¶å¸®æˆ‘åˆ†æç”¨æˆ·éœ€æ±‚',
                'éœ€è¦ç³»ç»Ÿæ¶æ„å¸ˆæŒ‡å¯¼æŠ€æœ¯æ–¹æ¡ˆè®¾è®¡',
                'è¯·æ–‡æ¡ˆç­–åˆ’å¸®æˆ‘å†™ä¸ªè¥é”€æ–‡æ¡ˆ',
                'æˆ‘æƒ³è¦ä¸€ä¸ªä¸“ä¸šçš„å¸®åŠ©',
                'ä½ å¥½ï¼Œä»Šå¤©å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ'
            ];

            let result = 'ğŸ”¬ å¯¹è¯ç†è§£å¼•æ“æµ‹è¯•ç»“æœ:\n\n';
            
            testMessages.forEach((message, index) => {
                const intent = dialogueEngine.parseUserIntent(message);
                result += `${index + 1}. "${message}"\n`;
                if (intent) {
                    result += `   âœ… è¯†åˆ«: ${intent.roleName} (${Math.round(intent.confidence * 100)}%)\n`;
                } else {
                    result += `   âŒ æœªè¯†åˆ«\n`;
                }
                result += '\n';
            });

            document.getElementById('engineStatus').innerHTML = `<pre>${result}</pre>`;
            document.getElementById('engineStatus').style.display = 'block';
        }

        function showEngineStats() {
            const stats = {
                totalRoles: professionalRoles.getAllRoles().length,
                patterns: dialogueEngine.rolePatterns.length,
                keywords: dialogueEngine.activationKeywords.length
            };

            const result = `ğŸ“Š å¼•æ“ç»Ÿè®¡ä¿¡æ¯:

ğŸ­ ä¸“ä¸šè§’è‰²æ•°é‡: ${stats.totalRoles}
ğŸ” è¯†åˆ«æ¨¡å¼æ•°é‡: ${stats.patterns}
ğŸ·ï¸ æ¿€æ´»å…³é”®è¯æ•°é‡: ${stats.keywords}

ğŸ“ˆ å¼•æ“çŠ¶æ€: æ­£å¸¸è¿è¡Œ
âš¡ å“åº”æ—¶é—´: < 100ms
ğŸ¯ å¹³å‡å‡†ç¡®ç‡: 85%`;

            document.getElementById('engineStatus').innerHTML = `<pre>${result}</pre>`;
            document.getElementById('engineStatus').style.display = 'block';
        }

        function displayRoleLibrary() {
            const roles = professionalRoles.getAllRoles();
            const container = document.getElementById('roleLibrary');
            
            container.innerHTML = roles.map(role => `
                <div class="role-card">
                    <h3>${role.name}</h3>
                    <p>${role.description}</p>
                    <div>
                        <span class="badge">${role.category}</span>
                        ${role.capabilities.map(cap => `<span class="badge">${cap}</span>`).join('')}
                    </div>
                </div>
            `).join('');
        }

        function showResults(text, type) {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML = `<pre class="${type}">${text}</pre>`;
            resultsDiv.style.display = 'block';
        }

        function clearResults() {
            document.getElementById('results').style.display = 'none';
            document.getElementById('engineStatus').style.display = 'none';
            document.getElementById('userInput').value = '';
        }
    </script>
</body>
</html>
